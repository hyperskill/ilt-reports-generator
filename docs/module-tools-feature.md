# Module Tools Feature

## Overview

The Module Tools feature allows administrators to generate and manage information about the tools, technologies, and platforms students will use in each course module. This feature uses LLM to analyze the course structure and suggest relevant tools.

## Features

### 1. LLM-Generated Tools Information
- For each module, admins can click "üîß Generate Tools" button
- LLM analyzes the module topics and course context
- Generates a list of tools, technologies, and platforms used
- Tools are categorized by type (e.g., Development Tools, AI Platforms)

### 2. Editable and Saveable
- Generated tools can be edited before saving
- Changes are saved to the database and persist across sessions
- Admin-only write access, managers can view only

### 3. Database Storage
- Tools stored in `module_tools` table
- One entry per module per report
- Includes module ID, title, tools text, and timestamps

## User Flow

### For Admins

1. **Navigate to Settings**
   - Go to report detail page
   - Click "Preview and Setup" tab
   - Click "Manage Settings" on General Report Settings card

2. **Generate Tools**
   - Find the module you want to work with
   - Click "üîß Generate Tools" button
   - Wait for LLM to analyze the module
   - Generated tools appear in the module card

3. **Edit Tools (Optional)**
   - Click "‚úèÔ∏è Edit" button next to Tools section
   - Modify the generated text as needed
   - Click "Save Changes" or "Cancel"

4. **Delete Tools**
   - Click "üóëÔ∏è Delete" button next to Tools section
   - Confirm deletion in the dialog
   - Tools are removed from database and UI

5. **View Tools**
   - Tools are displayed in a formatted text box
   - Each module shows its own tools separately

### For Managers

- Can view tools generated by admins
- Cannot generate or edit tools
- Read-only access to all tools information

## Technical Implementation

### Database Schema

```sql
create table public.module_tools (
  id uuid primary key,
  report_id uuid references reports(id),
  module_id integer not null,
  module_title text not null,
  tools text not null,
  created_by uuid references auth.users,
  created_at timestamp,
  updated_at timestamp,
  unique(report_id, module_id)
);
```

### API Endpoints

#### Generate Tools
**POST** `/api/llm/generate-module-tools`

Request body:
```json
{
  "courseStructure": [...],
  "moduleId": 123,
  "moduleTitle": "Module Name",
  "topics": [...]
}
```

Response:
```json
{
  "tools": "Generated tools text...",
  "moduleId": 123,
  "moduleTitle": "Module Name"
}
```

#### CRUD Operations
**GET** `/api/reports/module-tools?reportId=xxx`
- Fetch all tools for a report

**POST** `/api/reports/module-tools`
- Save or update tools for a module

**DELETE** `/api/reports/module-tools?reportId=xxx&moduleId=yyy`
- Delete tools for a module

### LLM Prompt

The system uses a specialized prompt to guide the LLM:

**System Prompt:**
- Expert in educational technology
- Identifies practical tools students will use
- **Makes suggestions ONLY based on module and topic names** (no assumptions beyond what's stated)
- Focuses on programming languages, frameworks, platforms, software
- **Outputs SHORT list of tool names only** (3-7 items max)
- **No detailed descriptions or explanations** - just tool names
- Can group related tools (e.g., "pandas, NumPy, scikit-learn")

**User Prompt:**
- Provides full course structure for context
- Focuses on specific module topics
- Requests SHORT bullet-point list of tools (3-7 items max)
- Emphasizes: no descriptions, just tool names

**Output Format Example:**
```
- Python
- Jupyter Notebook
- scikit-learn
- pandas, NumPy
- Matplotlib
```

## UI Components

### GeneralReportSettings Component
- State management for tools (separate from learning outcomes)
- `moduleTools`: Record of tools by module ID
- `generatingToolsModuleId`: Currently generating module
- `editingToolsModuleId`: Currently editing module
- `editToolsText`: Current edit buffer
- `savingToolsModuleId`: Currently saving module

### Functions
- `handleGenerateModuleTools()`: Trigger LLM generation
- `saveModuleTool()`: Save to database
- `handleEditToolsStart()`: Enter edit mode
- `handleEditToolsCancel()`: Cancel editing
- `handleEditToolsSave()`: Save edits
- `handleDeleteModuleTool()`: Delete tools with confirmation
- `handleDeleteLearningOutcome()`: Delete learning outcomes with confirmation

## Permissions

### Admin Role
- ‚úÖ Generate tools using LLM
- ‚úÖ Edit tools
- ‚úÖ Save tools
- ‚úÖ **Delete tools** (with confirmation dialog)
- ‚úÖ View all tools
- ‚úÖ Generate learning outcomes
- ‚úÖ Edit learning outcomes
- ‚úÖ **Delete learning outcomes** (with confirmation dialog)

### Manager Role
- ‚ùå Generate tools
- ‚ùå Edit tools
- ‚ùå Save tools
- ‚ùå Delete tools
- ‚úÖ View all tools
- ‚ùå Generate learning outcomes
- ‚ùå Edit learning outcomes
- ‚ùå Delete learning outcomes
- ‚úÖ View all learning outcomes

## Integration with Learning Outcomes

Both features work independently but follow similar patterns:

| Feature | Learning Outcomes | Module Tools |
|---------|------------------|--------------|
| **Icon** | üìö | üîß |
| **Button Color** | Default (blue) | Purple |
| **Purpose** | Educational objectives | Technologies used |
| **LLM Focus** | What students learn | What tools students use |
| **Display Order** | First | Second |

## Database Migration

To enable this feature, run:

```sql
-- Run this SQL in Supabase SQL Editor
\i supabase/add-module-tools.sql
```

This will:
1. Create `module_tools` table
2. Set up Row Level Security policies
3. Add indexes for performance
4. Configure update triggers

## Environment Variables

No additional environment variables required. Uses existing LiteLLM configuration:
- `LITELLM_BASE_URL`
- `LITELLM_API_KEY`
- `LITELLM_MODEL` (optional, defaults to gpt-4o-mini)

## Future Enhancements

Potential improvements:
1. Tool categories with icons
2. Direct links to tool documentation
3. Version tracking for tools
4. Tool usage statistics across modules
5. Automatic tool detection from code submissions
6. Integration with Cogniterra platform data

